# Обработка данных в датафрейме

### Варианты удаленния

- Удаление строк c нулевыми значениями в колонке "Col5"
```
df.dropna(subset="Col5", axis="index", inplace=True)
```

- Удаление колонок "Col1", "Col4"
```
df.drop(labels=["Col1", "Col4"], axis="columns", inplace=True)
```

- Если колонок много и переписывать их не комфортно, можно удалать по списку.
В этом примере составляется список "хороших" колонок, все остальные вносятся в список под удаление. 

```
    goodcol = ["Unnamed: 0", "Unnamed: 1", "Unnamed: 7"]
    dropcol = [x for x in df.columns if x not in goodcol]

    df.drop(
        labels=dropcol,
        axis="columns",
        inplace=True,
    )
```


- Удаление строк по условию: значение "Col1"==1
    !Важное замечание, удаление идёт по индексам строк, соответственно он должен быть уникальным. Если производилась операция слияния датафреймов надо выполнить resetindex.
```
df.drop(df[df["Col1"] ==1].index, inplace=True)
```
### Преобразование типов

- Заполнить нулями отсутствующие значения и преобразовать колонку "Суммы" в тип "Int64"
```
df["Суммы"] = df["Суммы"].fillna(0.0).astype("Int64")
```

- Преобразовать колонку "Описание" в тип "string"
```
df["Описание"] = df["Описание"].astype("string")
```
### Замена значений в колонке по шаблону

- Если надо заменить несколько вариантов значений, возможно использовать функцию map. Это позволит сделать замену за 1 проход.

```
df["Описание"] = df["Описание"].map(
        {
            "xx": "xx1",
            "yy": "yy1",
            "zz": "xx1",
        },
        na_action="ignore",
    )
```

- Замена значений по фильтру.
Пример фильтра:  если строка начинается с '10', то заменить на "значение1", остальные заменить на "значение2" 

``` 
mask = df["колонка"].str.match("10")
df.loc[mask, "колонка"] = "значение1"
df["колонка"].where(df["колонка"] == "значение1", "значение1", inplace=True)
``` 

    
    